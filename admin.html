<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>لوحة التحكم - إحصائيات الموقع</title>
    <style>
        body { font-family: 'Tajawal', sans-serif; padding: 20px; }
        .stats-container { display: flex; flex-wrap: wrap; gap: 20px; }
        .stat-card { background: #f5f5f5; padding: 20px; border-radius: 8px; flex: 1; min-width: 300px; }
        h1, h2 { color: #2D4159; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { padding: 10px; border: 1px solid #ddd; text-align: right; }
    </style>
</head>
<body>
    <h1>إحصائيات الموقع</h1>
    
    <div class="stats-container">
        <div class="stat-card">
            <h2>إجمالي الزيارات</h2>
            <div id="total-visits">جار التحميل...</div>
        </div>
        
        <div class="stat-card">
            <h2>إجمالي التحميلات</h2>
            <div id="total-downloads">جار التحميل...</div>
        </div>
    </div>
    
    <h2>التحميلات حسب نوع البطاقة</h2>
    <table id="card-stats">
        <thead>
            <tr>
                <th>نوع البطاقة</th>
                <th>عدد التحميلات</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
    
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-database-compat.js"></script>
    <script>
        // نفس تهيئة Firebase المستخدمة في الموقع الرئيسي
        const firebaseConfig = {
  apiKey: "AIzaSyC7RoFG-bxZVLVI-txBcAEDF_8Jr_57mBs",
  authDomain: "hrsd-fcb0e.firebaseapp.com",
  projectId: "hrsd-fcb0e",
  storageBucket: "hrsd-fcb0e.firebasestorage.app",
  messagingSenderId: "854796086468",
  appId: "1:854796086468:web:b58044e5ac266a34d6ed91",
  measurementId: "G-B9KVSWPRJQ"
        };
        
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();
        
        // جلب إجمالي الزيارات
        database.ref('visits').once('value').then(snapshot => {
            let total = 0;
            snapshot.forEach(daySnapshot => {
                total += daySnapshot.val();
            });
            document.getElementById('total-visits').textContent = total;
        });
        
        // جلب إجمالي التحميلات
        database.ref('downloads').once('value').then(snapshot => {
            let total = 0;
            snapshot.forEach(daySnapshot => {
                total += daySnapshot.val();
            });
            document.getElementById('total-downloads').textContent = total;
        });
        
        // جلب التحميلات حسب نوع البطاقة
        database.ref('card_downloads').once('value').then(snapshot => {
            const tbody = document.querySelector('#card-stats tbody');
            tbody.innerHTML = '';
            
            snapshot.forEach(cardSnapshot => {
                const row = document.createElement('tr');
                const nameCell = document.createElement('td');
                const countCell = document.createElement('td');
                
                nameCell.textContent = cardSnapshot.key;
                countCell.textContent = cardSnapshot.val();
                
                row.appendChild(nameCell);
                row.appendChild(countCell);
                tbody.appendChild(row);
            });
        });
    </script>
</body>
</html>